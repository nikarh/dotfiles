default_redirection_url: https://home.arhipov.net
theme: auto

server:
  host: 0.0.0.0
  port: 8080

log:
  level: debug
totp:
  issuer: home.arhipov.net

authentication_backend:
  file:
    path: /config/secrets/users_database.yml

access_control:
  networks:
  - name: internal
    networks:
    - 172.19.0.0/16
    - 192.168.1.0/24
  default_policy: deny
  rules:
    # Bypass
    - domain:
        - "files.home.arhipov.net"
      resources:
        - "^/api/public/(share|dl)/*"
        - "^/share/*"
        - "^/static/(js|css|img|themes|fonts)/*"
      policy: bypass
    - domain: traefik.home.arhipov.net
      policy: bypass
      networks:
        - internal
    - domain: roborock.home.arhipov.net
      policy: bypass
      networks:
        - internal
    - domain: torrents.files.home.arhipov.net
      policy: bypass
      networks:
        - internal
    - domain: netdata.files.home.arhipov.net
      policy: bypass
      networks:
        - internal
    # Specific configuration
    - domain: files.home.arhipov.net
      policy: one_factor
      subject:
        - "group:files"
    - domain: media.files.home.arhipov.net
      policy: one_factor
      subject:
        - "group:media"
    - domain: samba.files.home.arhipov.net
      policy: one_factor
      subject:
        - "group:samba"
    # Administrative
    - domain: netdata.files.home.arhipov.net
      policy: one_factor
      subject:
        - "group:admins"
    - domain: traefik.home.arhipov.net
      policy: one_factor
      subject:
        - "group:admins"
    # Residential
    - domain: roborock.home.arhipov.net
      policy: one_factor
      subject:
        - "group:residents"
    - domain: torrents.files.home.arhipov.net
      policy: one_factor
      subject:
        - "group:residents"
    - domain: hass.home.arhipov.net
      policy: one_factor
      subject:
        - "group:residents"
    # Personal
    - domain: syncthing.files.home.arhipov.net
      policy: one_factor
      subject:
        - "user:nikarh"

session:
  name: authelia_session
  expiration: 3600  # 1 hour
  inactivity: 300  # 5 minutes
  domain: home.arhipov.net

regulation:
  max_retries: 3
  find_time: 120
  ban_time: 300

storage:
  local:
    path: /config/db.sqlite3

notifier:
  disable_startup_check: true
  filesystem:
    filename: /config/notification.txt